<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MacaWelds - R18 Downloads</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <script src="script.js"></script>
    <header>
        <nav>
            <ul class="menu">
                <li>
                    <a href="./index.html">Home</a>
                </li>
                <li>
                    <a href="./MacaWelds.html">Welding & Engineering</a>
                    <ul>
                        <li><a href="#welding-services">Welding Services</a></li>
                        <li><a href="#engineering-services">Engineering Services</a></li>
                    </ul>
                <li>
                    <a href="./MacaDesign.html">SolidWorks Drawings</a>
                    <ul>
                        <li><a href="#assembly-designs">Assembly Designs</a></li>
                        <li><a href="#engineering-drawings">Engineering Drawings</a></li>
                    </ul>
                </li>
                <li>
                    <a href="./maca3d.html">3D Printing</a>
                    <ul>
                        <li><a href="./Pokemon.html">Pokemon</a></li>
                        <li><a href="./Gaming.html">Gaming Mods</a></li>
                        <li><a href="./FunctionalPrints.html">Functional Prints</a></li>
                        <li><a href="./maca3d4sale.html">3D Print Shop</a></li>
                    </ul>
                </li>
                <li><a href="./Dowloads.html">Downloads</a></li>
                <li><a href="./about.html">About</a></li>
                <li><a href="./contact.html">Contact</a></li>
            </ul>
        </nav>
        <h1 class="website-name">MacaWelds | MacaDesigns | Maca3D</h1>
    </header>

    <section>
        <h2>R18 Downloads</h2>
        <div class="thumbnails-gallery">
            <div class="thumbnails-info">
                <a href="./Downloads/Penis cap m6x0.8.3MF" class=" thumbnail"
                    onclick="confirmDownload('Penis ValveCaps')">
                    <img src="./Images/Maca3D/R18/Penis ValveCaps.JPG" alt="ValveCaps">
                </a>
                <p>Novelty ValveCaps R18</p>
            </div>
        </div>

    </section>

    <footer class="footer">
        <h2>Contact Us</h2>
        <p>Email: <a href="mailto:MacaWelds@outlook.com">MacaWelds@outlook.com</a></p>
        <p>Phone: <a href="tel:+64278909399">+64 27 890 9399</a></p>
        <p>Papanui, Christchurch</p>
        <p>&copy; 2023 MacaWelds. All rights reserved.</p>
    </footer>
    <script>
        var downloadCounters = {};

        function confirmDownload(fileName, element) {
            if (confirm('Do you want to download ' + fileName + '?')) {
                // Make a request to the download counter script
                fetch('./download_counter.php?file=' + fileName)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        // Update the download counter in the HTML
                        updateDownloadCounter(element, fileName, data.count);
                    })
                    .catch(error => {
                        console.error('Error:', error);
                    });

                // If the user clicks "OK", redirect to the download link
                window.location.href = './Downloads/' + fileName;
            } else {
                event.preventDefault();
            }
        }

        function updateDownloadCounter(element, fileName, count) {
            // Check if the counter element already exists
            var counterElement = element.querySelector('.download-counter');

            // If the counter element doesn't exist, create it
            if (!counterElement) {
                counterElement = document.createElement('span');
                counterElement.className = 'download-counter';
                element.appendChild(counterElement);
            }

            // Update the counter text
            counterElement.textContent = '(' + count + ' downloads)';
        }

        // Attach event listeners to download links
        var downloadLinks = document.querySelectorAll('.thumbnail');
        downloadLinks.forEach(function (link) {
            link.addEventListener('click', function (event) {
                confirmDownload(link.getAttribute('data-file'), link);
            });
        });
    </script>
</body>

</html>