<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MacaWelds - Free Downloads</title>
    <link rel="stylesheet" href="style.css">
    <script src="download_counter.js"></script>
</head>

<body>

    <header>
        <nav>
            <ul class="menu">
                <li>
                    <a href="./index.html">Home</a>
                </li>
                <li>
                    <a href="./MacaWelds.html">Welding & Engineering</a>
                    <ul>
                        <li><a href="#welding-services">Welding Services</a></li>
                        <li><a href="#engineering-services">Engineering Services</a></li>
                    </ul>
                <li>
                    <a href="./MacaDesign.html">SolidWorks Drawings</a>
                    <ul>
                        <li><a href="#assembly-designs">Assembly Designs</a></li>
                        <li><a href="./MacaDesign.html">Engineering Drawings</a></li>

                    </ul>
                </li>
                <li>
                    <a href="./maca3d.html">3D Printing</a>
                    <ul>
                        <li><a href="./Pokemon.html">Pokemon</a></li>
                        <li><a href="./Gaming.html">Gaming Mods</a></li>
                        <li><a href="./FunctionalPrints.html">Functional Prints</a></li>
                        <li><a href="./maca3d4sale.html">3D Print Shop</a></li>
                    </ul>
                </li>
                <li><a href="./Dowloads.html">Downloads</a></li>
                <li><a href="./about.html">About</a></li>
                <li><a href="./contact.html">Contact</a></li>
            </ul>
        </nav>
        <h1 class="website-name">MacaWelds | MacaDesigns | Maca3D</h1>
    </header>

    <section>
        <h2>Downloads</h2>
        <div class="thumbnails-gallery">
            <div class="thumbnails-info">
                <a href="./Downloads/Cat Food Lid.STL" class="thumbnail-download"
                    onclick="confirmDownload('Cat Food Lid.STL', this)">
                    <img src="./Images/Maca3D/House/Pets/Cat Food Lid2.JPG" alt="Cat Food Lid">
                    <img src="./Images/Maca3D/House/Pets/Cat Food Lid.JPG" alt="Cat Food Lid">
                </a>
                <p>Printed in TPU Fits straight onto cat food tins to keep fresh</p>
                <span class="download-counter" id="downloadCountCatFoodLid"></span>
            </div>
            <div class="thumbnails-info">
                <a href="./Downloads/Momo Brock - Brock Momo wheels-1.3mf" class="thumbnail-download"
                    onclick="confirmDownload('Momo Brock - Brock Momo wheels-1.3mf', this)">
                    <img src="./Images/Maca3D/For Sale/Mag Wheels/Momo Brock Complete.JPG"
                        alt="Peter Brock Momo Wheels">
                </a>
                <p>Replica of the Momo Wheel run by the Legend Peter Brock
                    Tyre TPU
                    Rim PLA/PETG
                </p>
                <span class="download-counter" id="downloadCountMomoBrock"></span>
            </div>

            <!-- Image to open the math quiz modal -->
            <img src="./Images/backgrounds/R18.png" alt="R18 Content" onclick="openMathQuiz()" style="cursor: pointer;">
        </div>

        <!-- The Modal -->
        <div id="mathQuizModal" class="modal">
            <!-- Modal content -->
            <div class="modal-content">
                <span class="close" onclick="closeMathQuiz()">&times;</span>
                <h2>Math Quiz</h2>
                <p id="mathEquation"></p>
                <input type="text" id="userAnswer" placeholder="Your Answer">
                <button onclick="checkAnswer()">Submit</button>
            </div>
        </div>

    </section>

    <footer class="footer">
        <h2>Contact Us</h2>
        <p>Email: <a href="mailto:MacaWelds@outlook.com">MacaWelds@outlook.com</a></p>
        <p>Phone: <a href="tel:+64278909399">+64 27 890 9399</a></p>
        <p>Papanui, Christchurch</p>
        <p>&copy; 2023 MacaWelds. All rights reserved.</p>
    </footer>
    <script>
        function openMathQuiz() {
            // Generate a random math equation
            var num1 = Math.floor(Math.random() * 10) + 1;
            var num2 = Math.floor(Math.random() * 10) + 1;
            var operator = ['+', '-', '*'][Math.floor(Math.random() * 3)];

            // Display the equation in the modal
            document.getElementById('mathEquation').innerText = num1 + ' ' + operator + ' ' + num2;

            // Show the modal
            document.getElementById('mathQuizModal').style.display = 'block';
        }

        function closeMathQuiz() {
            // Hide the modal
            document.getElementById('mathQuizModal').style.display = 'none';
        }

        function checkAnswer() {
            // Get user's answer and the correct answer
            var userAnswer = document.getElementById('userAnswer').value;
            var equation = document.getElementById('mathEquation').innerText;
            var correctAnswer = eval(equation);

            // Check if the answer is correct
            if (userAnswer == correctAnswer) {
                // Proceed to the R18 content downloads page
                window.location.href = './R18Content.html';
            } else {
                alert('Incorrect. Try again.');
            }
        }
        document.addEventListener('DOMContentLoaded', function () {
            // Initialize download counters on page load
            initializeDownloadCounters();

            // Attach event listeners to download links
            function confirmDownload(fileName, element) {
                if (confirm('Do you want to download ' + fileName + '?')) {
                    // Call the incrementDownloadCount function
                    incrementDownloadCount(fileName);
                    // Optionally, you can update the download counter immediately
                    updateDownloadCounter(fileName, 'downloadCount' + fileName.replace(/\s+/g, ''));
                } else {
                    event.preventDefault();
                }
            }

            // Function to initialize download counters
            function initializeDownloadCounters() {
                updateDownloadCounter('Cat Food Lid.STL', 'downloadCountCatFoodLid');
                updateDownloadCounter('Momo Brock - Brock Momo wheels-1.3mf', 'downloadCountMomoBrock');
                // Add similar lines for other downloads
            }

            // Function to increment download count for a file
            function incrementDownloadCount(fileName) {
                downloadCounts[fileName] = (downloadCounts[fileName] || 0) + 1;
                console.log(`Download count for ${fileName}: ${downloadCounts[fileName]}`);
            }

            // Function to update download counter in HTML
            function updateDownloadCounter(fileName, countElementId) {
                var counterElement = document.getElementById(countElementId);

                if (counterElement) {
                    counterElement.textContent = '(' + getDownloadCount(fileName) + ' downloads)';
                }
            }

            // Function to get download count for a file
            function getDownloadCount(fileName) {
                return downloadCounts[fileName] || 0;
            }

            // Fetch download counts when the page loads
            fetchDownloadCounts();
        });

        // Function to fetch download counts from GitHub Releases
        async function fetchDownloadCounts() {
            try {
                const response = await fetch('https://api.github.com/repos/MacaWelds/macawelds/releases');
                const releases = await response.json();

                releases.forEach(release => {
                    release.assets.forEach(asset => {
                        const fileName = asset.name;
                        const countElementId = 'downloadCount' + fileName.replace(/\s+/g, '');
                        const count = asset.download_count || 0;

                        incrementDownloadCount(fileName);
                        updateDownloadCounter(fileName, countElementId);
                    });
                });
            } catch (error) {
                console.error('Error fetching download counts:', error);
            }
        }

    </script>
</body>

</html>